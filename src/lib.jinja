{% macro translate(object, key, lang) %}
\o/ object[key + "_" + lang] if key + "_" + lang in object else (object[key] if key in object else "???") \o/
{% endmacro %}


{% macro product_item(product, lang) %}
<a href="\o/ product["id"] + "_" + lang \o/.html" class="product-item">
    <img src="media/\o/ product["image"] \o/" alt="\o/ translate(product, "name", lang) \o/">
    <div class="product-name">\o/ translate(product, "name", lang) \o/</div>
    <div class="product-price">\o/ translate(product, "price", lang) \o/</div>
</a>
{% endmacro %}

{% macro product_page(product, lang) %}
<section class="product-page">
  <div class="product-info">
    <h2>\o/ translate(product, "name", lang) \o/</h2>
    <section class="product-description">
      \o/ translate(product, "description", lang) \o/
    </section>
    /o/ if product["specs"] or product["specs" + "_" + lang] \o\
    <section class="product-specs">
      <h3>Specs</h3>
      <ul>
        /o/ for spec in (product["specs" + "_" + lang] if "specs" + "_" + lang in product else product["specs"]) \o\
          <li>â€”&nbsp;\o/ spec \o/</li>
        /o/ endfor \o\
      </ul>
    </section>
    /o/ endif \o\
    <section class="product-price">
      \o/ translate(product, "price", lang) \o/
    </section>
    <section class="product-links">
      <ul>
        <li class="links-label">
          \o/ "Liens:" if lang == "fr" else "Links:" \o/
        </li>
        /o/ for link in product["links"] \o\
        <a target="_blank" href="\o/ link['url'] \o/">
          <li class="link-block">\o/ translate(link, "name", lang) \o/</li>
        </a>
        /o/ endfor \o\
      </ul>
    </section>
  </div>
  <section class="product-image">
    <img src="media/\o/ product["image"] \o/" alt="\o/ product["name"] \o/">
  </section>
  <div class="product-gallery">
    /o/ for item in product["gallery"] \o\
        <!--<div class="zoom-wrapper">
          <img class="zoom-on-hover" src="media/\o/ item \o/"/>
        </div>-->


        <div class="zoom-wrapper">
          <div class="zoom-target" role="button" tabindex="0" aria-label="Zoom image">
            <img src="media/\o/ item \o/" alt="" class="zoomable">
          </div>
          <div class="zoom-close" role="button" aria-label="Close"></div>
          <div class="zoom-dismiss" aria-hidden="true"></div>
        </div>

    /o/ endfor \o\
  </div>
</section>
{% endmacro %}

{% macro category_item(category, lang) %}
<a href="\o/ category["id"] + "_" + lang \o/.html">\o/ translate(category, "name", lang) \o/</a>
{% endmacro %}

{% macro category_page(category, lang) %}
<section class="product-grid with-sub-title">

/o/ for product in _o_["load_yaml"]("products.yaml") \o\
/o/ if category["id"] in product.get("tags", []) \o\

\o/ product_item(product, lang) \o/

/o/ endif \o\
/o/ endfor \o\
</section>
{% endmacro %}